# KeyManager
## Название и назначение сервиса
Микросервис EncryptionService предназначен для шифрования и дешифрования файл методом blowfish. Этот микросервис получает запросы на шифровку/дешифровку файлов от телеграм-бота и запрашивает ключ у микросервиса KeyManager.
Расшифровать файл имеет право только тот пользователь, которой зашифровал файл.

---

## Архитектура и зависимости
### Технологии и фреймворки
- Язык программирования: **PHP 8.4.1**
- Фреймворк: **Laravel 12.3.0**

### Взаимодействие с другими микросервисамисервисами
Сервис обменивается данными с:
- **[TelegramBot](https://github.com/svetlana7474/PIUS)**  — для полчения запросов на шифрование/дешифрование файлов.
- **[EncryptionService](https://github.com/Jotaro220/EncryptionService)**  — для шифрования/дешифрования файлов.

---

## Способы запуска сервиса
### Локальный запуск без docker
php artisan serve
### Локальный запуск через docker 
docker-compose up

---

## API документация
[OpenApi документация]((https://github.com/KRISPIH/KeyManager/blob/main/docs/KeyGen.yaml))
### Основные эндпоинты

#### Шифрование/дешифрование файлов
**Endpoint**: `POST /api/v1/key/generate`

**Описание**:  
Описание: Генерирует и сохраняет симметричный ключ для пользователя и файла.

**Параметры запроса**:
| Параметр  | Тип     | Обязательный | Описание                          | Пример значения        |
|-----------|---------|--------------|-----------------------------------|------------------------|
| `telegram_code` | string | Да           | ID пользователя                   | `123456789`            |
| `file_name`    | string  | Да           | 	Имя файла, для которого нужен ключ            | `"myfile.txt"` |

**Endpoint**: `POST /api/v1/key/key_get`

**Описание**:  
Описание: Получает ключ по ID записи и Telegram-коду пользователя. Расшифровать файл может только тот, кто его зашифровал.

**Параметры запроса**:
| Параметр  | Тип     | Обязательный | Описание                          | Пример значения        |
|-----------|---------|--------------|-----------------------------------|------------------------|
| `telegram_code` | string | Да           | ID пользователя                   | `123456789`            |
| `id`    | integer  | Да           | 	ID записи с ключом            | `"4"` |

---

## Как тестировать
Команда для запуска тестов - **php artisan test**

---

## Контакты
- **Разработчик**: 
  - [KRISPIH](https://github.com/KRISPIH)
  
